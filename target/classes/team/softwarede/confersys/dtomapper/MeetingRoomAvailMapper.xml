<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="team.softwarede.confersys.dtomapper.MeetingRoomAvailMapper">
  <resultMap id="BaseResultMap" type="team.softwarede.confersys.dto.MeetingRoomAvail">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed May 29 09:02:50 CST 2019.
    -->
    <id column="id" jdbcType="INTEGER" property="id" />
    <result column="room_number" jdbcType="VARCHAR" property="roomNumber" />
    <result column="building" jdbcType="VARCHAR" property="building" />
    <result column="floor" jdbcType="INTEGER" property="floor" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed May 29 09:02:50 CST 2019.
    -->
    id, room_number, building, floor
  </sql>
  <select id="selectBookAvailList" resultMap="BaseResultMap">
    select 
    <include refid="Base_Column_List" />
    from meeting_room
    where id in (
    (
	    select mtroom_id 
	    from meeting_room_schedule
	    where (UNIX_TIMESTAMP(end_time) &gt; ${beginTime} or
	           UNIX_TIMESTAMP(begin_time) &lt; ${endTime})
    )INNER JOIN(
        select mtroom_id
        from equipment 
        where equipment_type_id in 
        <foreach collection="list" index="index" item="item" open="("
        separator="," close=")">
        #{item}
    </foreach>
    )INNER JOIN(
        select mtroom_id
        from meeting_room
        where capacity &lt; ${capacity}
    )
)

</mapper>